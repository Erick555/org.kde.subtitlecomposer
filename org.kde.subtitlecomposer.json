{
    "id": "org.kde.subtitlecomposer",
    "runtime": "org.kde.Platform",
    "runtime-version": "5.15-21.08",
    "sdk": "org.kde.Sdk",
    "command": "subtitlecomposer",
    "finish-args": [
        "--share=ipc",
        "--device=dri",
        "--socket=fallback-x11",
        "--socket=wayland",
        "--socket=pulseaudio"
    ],
    "cleanup": [
        "*.la",
        "*.a",
        "/include",
        "/lib/cmake",
        "/lib/pkgconfig",
        "/mkspecs",
        "/share/pkgconfig",
        "/share/aclocal",
        "/share/info",
        "/man",
        "/share/man"
    ],
    "rename-icon": "subtitlecomposer",
    "modules": [
        {
            "name": "ffmpeg",
            "config-opts": [
                "--enable-gpl",
                "--enable-version3",
                "--disable-static",
                "--enable-shared",
                "--disable-doc",
                "--enable-postproc",
                "--enable-pthreads",
                "--disable-avisynth",
                "--enable-gmp",
                "--enable-gnutls",
                "--disable-ladspa",
                "--enable-libaom",
                "--enable-libass",
                "--disable-libbluray",
                "--enable-libdav1d",
                "--enable-libfontconfig",
                "--enable-libfreetype",
                "--enable-libfribidi",
                "--enable-libgsm",
                "--disable-libiec61883",
                "--disable-libjack",
                "--enable-libmodplug",
                "--enable-libmp3lame",
                "--enable-libopencore-amrnb",
                "--enable-libopencore-amrwb",
                "--disable-libopenjpeg",
                "--enable-libopus",
                "--disable-libpulse",
                "--disable-librav1e",
                "--disable-librsvg",
                "--enable-libsoxr",
                "--enable-libspeex",
                "--disable-libsrt",
                "--disable-libssh",
                "--disable-libsvtav1",
                "--enable-libtheora",
                "--disable-libv4l2",
                "--disable-libvidstab",
                "--enable-libvmaf",
                "--enable-libvorbis",
                "--enable-libvpx",
                "--enable-libwebp",
                "--disable-libx264",
                "--disable-libx265",
                "--disable-libxvid",
                "--enable-libxml2",
                "--enable-libzimg",
                "--enable-amf",
                "--disable-cuda-llvm",
                "--enable-libdrm",
                "--disable-libmfx",
                "--enable-lto",
                "--disable-debug",
                "--disable-stripping",
                "--disable-encoders",
                "--disable-muxers",
                "--disable-devices"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ffmpeg.org/releases/ffmpeg-5.1.2.tar.xz",
                    "sha256": "619e706d662c8420859832ddc259cd4d4096a48a2ce1eefd052db9e440eef3dc",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 5405,
                        "stable-only": true,
                        "url-template": "https://ffmpeg.org/releases/ffmpeg-$version.tar.xz"
                    }
                }
            ],
            "cleanup": [
                "/share/ffmpeg/examples"
            ],
            "modules": [
                {
                    "name": "gsm",
                    "no-autogen": true,
                    "build-commands": [
                        "install -dm755 ${FLATPAK_DEST}/{include,lib,man/man{1,3}}"
                    ],
                    "make-install-args": [
                        "-j1",
                        "INSTALL_ROOT=${FLATPAK_DEST}",
                        "GSM_INSTALL_INC=${FLATPAK_DEST}/include"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "http://www.quut.com/gsm/gsm-1.0.22.tar.gz",
                            "sha256": "f0072e91f6bb85a878b2f6dbf4a0b7c850c4deb8049d554c65340b3bf69df0ac",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 12587,
                                "stable-only": true,
                                "url-template": "http://www.quut.com/gsm/gsm-$version.tar.gz"
                            }
                        },
                        {
                            "type": "patch",
                            "path": "patches/deps/gsm-shared_lib.patch"
                        },
                        {
                            "type": "shell",
                            "commands": [
                                "sed -i '/^CC.*= gcc/d' Makefile",
                                "sed -i 's/^\\(CCFLAGS .*\\)/\\1 -fPIC/' Makefile",
                                "install -dm755 ${FLATPAK_DEST}/{bin,include,lib32}"
                            ]
                        }
                    ],
                    "cleanup": [
                        "/bin",
                        "/man"
                    ]
                },
                {
                    "name": "amf-headers",
                    "buildsystem": "simple",
                    "build-commands": [
                        "install -dm755 ${FLATPAK_DEST}/include/",
                        "cp --recursive --no-dereference --preserve=links --no-preserve=ownership amf/public/include ${FLATPAK_DEST}/include/AMF"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://github.com/GPUOpen-LibrariesAndSDKs/AMF/archive/v1.4.26/AMF-1.4.26.tar.gz",
                            "sha256": "fe8b8f370710b159a92d75eee8a8ea557f0a6ca7d6c0436eb44db31cec06b9b7",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 138182,
                                "stable-only": true,
                                "versions": {
                                    ">": "1.4.21"
                                },
                                "url-template": "https://github.com/GPUOpen-LibrariesAndSDKs/AMF/archive/v$version/AMF-$version.tar.gz"
                            }
                        }
                    ]
                },
                {
                    "name": "ffnvcodec-headers",
                    "no-autogen": true,
                    "make-install-args": [
                        "PREFIX=${FLATPAK_DEST}"
                    ],
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://git.videolan.org/git/ffmpeg/nv-codec-headers.git",
                            "tag": "n11.1.5.2",
                            "commit": "f8ae7a49bfef2f99d2c931a791dc3863fda67bf3",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 223796,
                                "stable-only": true,
                                "tag-template": "n$version"
                            }
                        }
                    ]
                },
                {
                    "name": "libass",
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://github.com/libass/libass/releases/download/0.16.0/libass-0.16.0.tar.xz",
                            "sha256": "5dbde9e22339119cf8eed59eea6c623a0746ef5a90b689e68a090109078e3c08",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 1560,
                                "stable-only": true,
                                "url-template": "https://github.com/libass/libass/releases/download/$version/libass-$version.tar.xz"
                            }
                        }
                    ]
                },
                {
                    "name": "libmodplug",
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://downloads.sourceforge.net/modplug-xmms/libmodplug-0.8.9.0.tar.gz",
                            "sha256": "457ca5a6c179656d66c01505c0d95fafaead4329b9dbaa0f997d00a3508ad9de",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 5669,
                                "stable-only": true,
                                "url-template": "https://downloads.sourceforge.net/modplug-xmms/libmodplug-$version.tar.gz"
                            }
                        }
                    ]
                },
                {
                    "name": "libsoxr",
                    "builddir": true,
                    "buildsystem": "cmake",
                    "config-opts": [
                        "-DCMAKE_BUILD_TYPE=Release",
                        "-DBUILD_EXAMPLES=OFF",
                        "-DBUILD_SHARED_LIBS=ON",
                        "-DWITH_AVFFT=ON",
                        "-DWITH_LSR_BINDINGS=ON",
                        "-DWITH_OPENMP=ON",
                        "-DWITH_PFFFT=ON"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://downloads.sourceforge.net/soxr/soxr-0.1.3-Source.tar.xz",
                            "sha256": "b111c15fdc8c029989330ff559184198c161100a59312f5dc19ddeb9b5a15889",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 4859,
                                "stable-only": true,
                                "url-template": "https://downloads.sourceforge.net/soxr/soxr-$version-Source.tar.xz"
                            }
                        }
                    ]
                },
                {
                    "name": "opencore-amr",
                    "config-opts": [
                        "--disable-static",
                        "--disable-examples"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://downloads.sourceforge.net/opencore-amr/opencore-amr-0.1.6.tar.gz",
                            "sha256": "483eb4061088e2b34b358e47540b5d495a96cd468e361050fae615b1809dc4a1",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 21548,
                                "stable-only": true,
                                "url-template": "https://downloads.sourceforge.net/opencore-amr/opencore-amr-$version.tar.gz"
                            }
                        }
                    ]
                },
                {
                    "name": "vmaf",
                    "builddir": true,
                    "subdir": "libvmaf",
                    "buildsystem": "meson",
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://github.com/Netflix/vmaf/archive/v2.3.1/vmaf-2.3.1.tar.gz",
                            "sha256": "8d60b1ddab043ada25ff11ced821da6e0c37fd7730dd81c24f1fc12be7293ef2",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 178322,
                                "stable-only": true,
                                "url-template": "https://github.com/Netflix/vmaf/archive/v$version/vmaf-$version.tar.gz"
                            }
                        }
                    ]
                },
                {
                    "name": "zimg",
                    "config-opts": [
                        "--disable-static",
                        "--enable-x86simd"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://github.com/sekrit-twc/zimg/archive/release-3.0.4/zimg-release-3.0.4.tar.gz",
                            "sha256": "219d1bc6b7fde1355d72c9b406ebd730a4aed9c21da779660f0a4c851243e32f",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 13685,
                                "stable-only": true,
                                "url-template": "https://github.com/sekrit-twc/zimg/archive/release-$version/zimg-release-$version.tar.gz"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "SphinxBase",
            "buildsystem": "autotools",
            "config-opts": [
                "--without-python"
            ],
            "cleanup": [
                "/share/sphinxbase"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/cmusphinx/sphinxbase.git",
                    "commit": "9e901850ee4cd1c0b22f2d3b3c15f162564ca283"
                }
            ]
        },
        {
            "name": "PocketSphinx",
            "buildsystem": "autotools",
            "config-opts": [
                "--without-python"
            ],
            "cleanup": [
                "/share/pocketsphinx"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/cmusphinx/pocketsphinx.git",
                    "commit": "588ab6371a1e1c94c10d4ad772b0c4732e1905e6"
                }
            ]
        },
        {
            "name": "kross",
            "buildsystem": "cmake-ninja",
            "config-opts": [
                "-DENABLE_TESTING=OFF"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.kde.org/stable/frameworks/5.99/portingAids/kross-5.99.0.tar.xz",
                    "sha256": "7bf7a895f15554e4a88d63aa2216be9af7662bb8c28e56bad5b31953a97788d6",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 8762,
                        "stable-only": true,
                        "url-template": "https://download.kde.org/stable/frameworks/$major.$minor/portingAids/kross-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "buildsystem": "cmake-ninja",
            "name": "subtitlecomposer",
            "config-opts": [
                "-DBUILD_TESTING=OFF"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.kde.org/stable/subtitlecomposer/subtitlecomposer-0.7.1.tar.xz",
                    "sha256": "ef9cb3c0c1fe1f40cf9d8e795859b9b28adf2da3be77a076d46bc28df4cd0255",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 242855,
                        "stable-only": true,
                        "url-template": "https://download.kde.org/stable/subtitlecomposer/subtitlecomposer-$version.tar.xz"
                    }
                }
            ]
        }
    ]
}
